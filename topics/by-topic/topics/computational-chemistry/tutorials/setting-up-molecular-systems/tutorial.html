<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Setting up molecular systems</title>
        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-45719423-18' , 'auto');
            ga('send', 'pageview');
        </script>
        
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap.min.css?v=3">
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap-toc.min.css">
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=2">
        <link rel="stylesheet" href="/training-material/assets/css/font-awesome.css">
        <link rel="stylesheet" href="/training-material/assets/css/academicons.css">
        <link rel="stylesheet" href="/training-material/assets/css/syntax_highlighting.css">
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon" />

        
        
        
        
        
        <meta name="description" content="Modelling, simulation and analysis of biomolecular systems" />
        <meta property="og:title" content="Galaxy Training: Setting up molecular systems" />
        <meta property="og:description" content="Modelling, simulation and analysis of biomolecular systems" />
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png" />
    </head>
    <body data-spy="scroll" data-target="#toc">
        











<header>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                Galaxy Training!
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/topics/computational-chemistry" title="Go back to list of tutorials">
                            <i class="fa fa-folder-o" aria-hidden="true"></i><span class="visually-hidden">topic</span> Computational chemistry
                        </a>
                    </li>

                    <li class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="EN">
                            EN
                        </a>
                        <div class="dropdown-menu">
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=fr&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fcomputational-chemistry%2Ftutorials%2Fsetting-up-molecular-systems%2Ftutorial.html&edit-text=&act=url" title="">
                                FR
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ja&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fcomputational-chemistry%2Ftutorials%2Fsetting-up-molecular-systems%2Ftutorial.html&edit-text=&act=url" title="">
                                JA
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=es&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fcomputational-chemistry%2Ftutorials%2Fsetting-up-molecular-systems%2Ftutorial.html&edit-text=&act=url" title="">
                                ES
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=pt&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fcomputational-chemistry%2Ftutorials%2Fsetting-up-molecular-systems%2Ftutorial.html&edit-text=&act=url" title="">
                                PT
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ar&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fcomputational-chemistry%2Ftutorials%2Fsetting-up-molecular-systems%2Ftutorial.html&edit-text=&act=url" title="">
                                AR
                            </a>
                            
                        </div>
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="fa fa-life-ring" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>

        <div class="dropdown-divider"></div>
        <a class="dropdown-item" href="/training-material/faq" title="Check our FAQ">
            FAQ
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Chat on Gitter">
            Chat on Gitter
        </a>
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            Discuss on Galaxy Help
        </a>
    </div>
</li>


                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/galaxyproject/training-material/edit/master/topics/computational-chemistry/tutorials/setting-up-molecular-systems/tutorial.md">
                            <i class="fa fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<div class="container main-content">
    <script type="application/ld+json">
        


{
  "@context": "http://schema.org",
  "@type": "Course",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "Short descriptions are present but long descriptions will be needed for non-visual users",
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Setting up molecular systems",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "license": "/blob//LICENSE.md",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "courseCode": "computational-chemistry / setting-up-molecular-systems / hands-on",
  "learningResourceType": "hands-on tutorial",
  "name": "Hands-on for 'Setting up molecular systems' tutorial",
  "isPartOf": {
    "@type": "Course",
    "name": "Setting up molecular systems",
    "description": "Setting up molecular systems",
    "learningResourceType": "tutorial",
    "interactivityType": "expositive",
    "provider": {
      "@type": "Organization",
      "email": "galaxytrainingnetwork@gmail.com",
      "name": "Galaxy Training Network",
      "url": "https://galaxyproject.org/teach/gtn/"
    }
  },
  "url": "https://galaxyproject.github.io//training-material/topics/computational-chemistry/tutorials/setting-up-molecular-systems/tutorial.html",
  "timeRequired": "PT2H",
  "description": "Setting up molecular systems\\nThe questions this  addresses are:\n - How to get started modelling a protein and a ligand?\n\n\\nThe objectives are:\n - learn about the Protein Data Bank\n - learn how to set up up a model protein and ligand system (with CHARMM-GUI)\n - learn how to upload the system to Galaxy\n\n",
  "coursePrerequisites": [
    {
      "@type": "CreativeWork",
      "url": "https://galaxyproject.github.io//training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://galaxyproject.github.io//training-material/topics/computational-chemistry/tutorials/setting-up-molecular-systems/tutorial.html",
      "name": "Setting up molecular systems",
      "description": "Hands-on for 'Setting up molecular systems' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    }
  ],
  "hasPart": [

  ],
  "mentions": [
    {
      "@type": "Thing",
      "url": "https://zenodo.org/record/2600690",
      "name": "Training data for Setting up molecular systems tutorial"
    }
  ],
  "author": [
    {
      "@type": "Person",
      "name": "Chris Barnett"
    },
    {
      "@type": "Person",
      "name": "Simon Bray"
    }
  ],
  "contributor": [
    {
      "@type": "Person",
      "name": "Chris Barnett"
    },
    {
      "@type": "Person",
      "name": "Simon Bray"
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Computational chemistry",
      "description": "Modelling, simulation and analysis of biomolecular systems",
      "url": "https://galaxyproject.github.io//training-material/topics/computational-chemistry/"
    }
  ],
  "skillLevel": "Intermediate"
}
    </script>

    <section class="tutorial">
        <h1 data-toc-skip>Setting up molecular systems</h1>
        <div class="contributors-line">By: 

<a href="/training-material/hall-of-fame#chrisbarnettster" class="contributor-badge"><img src="https://avatars.githubusercontent.com/chrisbarnettster" alt="Chris Barnett">Chris Barnett</a>, <a href="/training-material/hall-of-fame#simonbray" class="contributor-badge"><img src="https://avatars.githubusercontent.com/simonbray" alt="Simon Bray">Simon Bray</a>

</div>
        <blockquote class="overview">
            <h3>Overview</h3>
            <strong><i class="fa fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</strong>
            <ul>
            
            <li>How to get started modelling a protein and a ligand?</li>
            
            </ul>

            <strong><i class="fa fa-bullseye" aria-hidden="true"></i><span class="visually-hidden">objectives</span> Objectives</strong>
            <ul>
            
            <li>learn about the Protein Data Bank</li>
            
            <li>learn how to set up up a model protein and ligand system (with CHARMM-GUI)</li>
            
            <li>learn how to upload the system to Galaxy</li>
            
            </ul>

            
            <strong><i class="fa fa-check-circle" aria-hidden="true"></i><span class="visually-hidden">requirements</span> Requirements</strong>
            <ul>
            
    <li>
    
        
        
        <a href="/training-material/topics/introduction">Introduction to Galaxy Analyses</a>
        
    
    </li>

            
    <li>
    
        
        
        <a href="/training-material/topics/computational-chemistry">Computational chemistry</a>
        
            <ul>
                
                    
                        
                    
                        
                    
                        
                    
                        
                            
                            <li> Setting up molecular systems:
                            
                            
                                
                                     <a href="/training-material/topics/computational-chemistry/tutorials/setting-up-molecular-systems/tutorial.html"><i class="fa fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on</a>
                                
                            
                            </li>
                        
                    
                
            </ul>
        
    
    </li>

            </ul>
            

            
            <p><strong><i class="fa fa-hourglass-end" aria-hidden="true"></i><span class="visually-hidden">time</span> Time estimation:</strong> 2 hours</p>
            

            
            <p><strong><i class="fa fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span> Level: </strong>
             Intermediate 
<span class="level intermediate" title="Intermediate Tutorial">
  <i class="fa fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span> <i class="fa fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span> <i class="fa fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span>
</span>

</p>
            



            <div>
                <div><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials</strong></div>
                <div id="supporting_materials">
                    <ul>
                        <li>
                            <div>
                    

                    
                    <div>
                        
<a class="topic-icon" href="https://zenodo.org/record/2600690">
    <i class="fa fa-files-o" aria-hidden="true"></i><span class="visually-hidden">zenodo_link</span> Datasets
</a>


                    </div>
                    

                    
                    


                    
                    
                    <div>
                        

    <a href="#" class="btn btn-default dropdown-toggle topic-icon" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fa fa-cog" aria-hidden="true"></i><span class="visually-hidden">instances</span> Galaxies
    </a>
    <ul class="dropdown-menu">
    
        <li>
            <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/tree/master/topics/computational-chemistry/docker" title="Docker image for this tutorial">
                <i class="fa fa-ship" aria-hidden="true"></i><span class="visually-hidden">docker_image</span> Docker image
            </a>
        </li>
    
    
    </ul>



                    </div>
                    
                    
                            </div>
                        </li>
                    </ul>
                </div>

            </div>

        </blockquote>

        <div class="container">
            <div class="row">
                <!-- sidebar, which will move to the top on a small screen -->
                <div class="col-sm-2">
                    <nav id="toc" data-toggle="toc" class="sticky-top"></nav>
                </div>
                <div class="col-sm-10">
                    <blockquote class="comment">
  <h3 id="comment-audience"><i class="fa fa-commenting-o" aria-hidden="true"></i><span class="visually-hidden">comment</span> Audience</h3>
  <p>This tutorial is intended for those who are new to the computational chemistry tools in Galaxy.</p>
</blockquote>

<h1 class="no_toc" id="introduction">Introduction</h1>

<p>In this tutorial, we’ll cover the basics of molecular modelling by setting up a protein in complex with a ligand and uploading the structure to Galaxy. This tutorial will make use of CHARMM-GUI. Please note that the follow-up to this tutorial (located <a href="/training-material/topics/computational-chemistry/tutorials/md-simulation-namd/tutorial.html">here</a>) requires access to NAMD Galaxy tools, which can be accessed using the <a href="https://github.com/scientificomputing/BRIDGE">Docker container</a> but are currently not available on any public Galaxy server.</p>

<blockquote class="agenda">
  <h3 id="agenda">Agenda</h3>

  <p>In this tutorial, we will cover:</p>

<ol id="markdown-toc">
  <li><a href="#cellulase-and-cellulose" id="markdown-toc-cellulase-and-cellulose">Cellulase and cellulose</a>    <ol>
      <li><a href="#get-data" id="markdown-toc-get-data">Get data</a></li>
    </ol>
  </li>
  <li><a href="#modelling-with-charmm-gui" id="markdown-toc-modelling-with-charmm-gui">Modelling with CHARMM-GUI</a>    <ol>
      <li><a href="#charmm" id="markdown-toc-charmm">CHARMM</a></li>
      <li><a href="#namd" id="markdown-toc-namd">NAMD</a></li>
    </ol>
  </li>
</ol>

</blockquote>

<h1 id="cellulase-and-cellulose">Cellulase and cellulose</h1>

<p>To start we’ll look at the PDB and find the entry for a fungal enzyme that cleaves cellulose. The enzyme is 7CEL, a hydrolase as seen in <a href="#figure-1">the figure.</a></p>

<figure id="figure-1"><img src="/training-material/topics/computational-chemistry/images/enzyme.jpg" alt="Snapshot of 7CEL pdb with octaose ligand" /><figcaption><span class="figcaption-prefix">Figure 1:</span> 7CEL Cellulase with a short chain cellulose (octaose) ligand</figcaption></figure>

<p>In this section we’ll access the PDB, download the correct structure, import it and view in Galaxy.</p>

<blockquote class="details">
  <h3 id="details-background-what-is-the-pdb-protein-data-bank-and-format"><i class="fa fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> Background: What is the PDB (Protein Data Bank) and format?</h3>

  <p>The Protein Data Bank (PDB) format contains atomic coordinates of biomolecules and provides a standard representation for macromolecular structure data derived from X-ray diffraction and NMR studies. Each structure is stored under a four-letter accession code. For example, the PDB file we will use is assigned the code <a href="https://www.rcsb.org/pdb/explore/explore.do?structureId=7CEL">7CEL</a>).</p>

  <p>More resources:</p>

  <ul>
    <li>Multiple structures are stored and can be queried at <a href="https://www.rcsb.org/">https://www.rcsb.org/</a></li>
    <li>Documentation describing the PDB file format is available from the wwPDB at <a href="http://www.wwpdb.org/documentation/file-format.php">http://www.wwpdb.org/documentation/file-format.php</a>.</li>
  </ul>
</blockquote>

<blockquote class="details">
  <h3 id="details-background-why-choose-a-cellulase"><i class="fa fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> Background: Why choose a cellulase?</h3>

  <p>Using enzymes to break down abundant cellulose into disaccharide units (cellobiose) is a method to optimise the
biofuel process. <a class="citation" href="#barnett11">Barnett <i>et al.</i> 2011</a></p>

  <p>More resources:</p>

  <ul>
    <li><a href="https://en.wikipedia.org/wiki/Cellulase">https://en.wikipedia.org/wiki/Cellulase</a></li>
    <li><a href="https://en.wikipedia.org/wiki/Biofuel">https://en.wikipedia.org/wiki/Biofuel</a></li>
    <li><a href="https://pubs.acs.org/doi/full/10.1021/cr500351c">Fungal Cellulases</a></li>
    <li><a href="https://pubs.acs.org/doi/10.1021/ja103766w">Cellobiohydrolase I Induced Conformational Stability and Glycosidic Bond Polarization </a></li>
  </ul>
</blockquote>

<h2 id="get-data">Get data</h2>

<p>The 7CEL <a href="https://files.rcsb.org/download/7CEL.pdb">PDB</a> does not include a complete 8 unit substrate and some modelling is required. The correctly modelled substrate is provided for this tutorial.</p>
<blockquote class="details">
  <h3 id="details-more-details-about-the-modelling-done"><i class="fa fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> More details about the modelling done</h3>
  <ul>
    <li>VMD (visualisation software) was used for atomic placement and CHARMM was used for energy minimisation.</li>
    <li>The PDB structure contains a mutation at position 217 (glumatate to glutamine). Our structure reverses this.</li>
    <li>The ligand was modelled separately and inserted into the binding site.</li>
  </ul>

</blockquote>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-data-upload"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Data upload</h3>

  <ol>
    <li>
      <p>Create a new history for this tutorial.</p>

      <blockquote class="tip">

        <h3 id="tip-tip-creating-a-new-history"><i class="fa fa-lightbulb-o" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Creating a new history</h3>

        <p>Click the <i class="fa fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> icon at the top of the history panel</p>

        <p>If the <i class="fa fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> is missing:</p>
        <ol>
          <li>Click on the <i class="fa fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> icon (<strong>History options</strong>) on the top of the history panel</li>
          <li>Select the option <strong>Create New</strong> from the menu</li>
        </ol>
      </blockquote>
    </li>
    <li>Import the files from the Zenodo link provided.
      <blockquote>
        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/2600690
</code></pre></div>        </div>
      </blockquote>

      <blockquote class="tip">

        <h3 id="tip-tip-importing-data-via-links"><i class="fa fa-lightbulb-o" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Importing data via links</h3>

        <ul>
          <li>Copy the link location</li>
          <li>
            <p>Open the Galaxy Upload Manager (<i class="fa fa fa-upload" aria-hidden="true"></i><span class="visually-hidden">galaxy-upload</span> on the top-right of the tool panel)</p>
          </li>
          <li>Select <strong>Paste/Fetch Data</strong></li>
          <li>
            <p>Paste the link into the text field</p>
          </li>
          <li>
            <p>Press <strong>Start</strong></p>
          </li>
          <li><strong>Close</strong> the window</li>
        </ul>

        <p>By default, Galaxy uses the URL as the name, so rename the files with a more useful name.</p>
      </blockquote>

      <blockquote class="tip">

        <h3 id="tip-tip-importing-data-from-a-data-library"><i class="fa fa-lightbulb-o" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Importing data from a data library</h3>

        <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>

        <ul>
          <li>
            <p>Go into <strong>Shared data</strong> (top panel) then <strong>Data libraries</strong></p>
          </li>
          <li>
            <p>Find the correct folder (ask your instructor)</p>
          </li>
          <li>Select the desired files</li>
          <li>Click on the <strong>To History</strong> button near the top and select <strong>as Datasets</strong> from the dropdown menu</li>
          <li>In the pop-up window, select the history you want to import the files to (or create a new one)</li>
          <li>Click on <strong>Import</strong></li>
        </ul>
      </blockquote>
    </li>
    <li>Rename the datasets.</li>
    <li>
      <p>Check that the datatype is correct. The file should have the PDB datatype.</p>

      <blockquote class="tip">

        <h3 id="tip-tip-changing-the-datatype"><i class="fa fa-lightbulb-o" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Changing the datatype</h3>
        <ul>
          <li>Click on the <i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>
          <li>In the central panel, click on the <i class="fa fa fa-database" aria-hidden="true"></i><span class="visually-hidden">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>
          <li>Select <code class="highlighter-rouge">datatypes</code></li>
          <li>Click the <strong>Change datatype</strong> button</li>
        </ul>
      </blockquote>
    </li>
  </ol>

</blockquote>

<h1 id="modelling-with-charmm-gui">Modelling with CHARMM-GUI</h1>
<p>It is convenient to set up the molecular system outside Galaxy using a tool such as CHARMM-GUI. Alternative methods are possible - see the <a href="/training-material/topics/computational-chemistry/tutorials/md-simulation-gromacs/tutorial.html">GROMACS tutorial</a> for an example. <a class="citation" href="#jo17">Jo <i>et al.</i> 2016</a></p>

<blockquote class="tip">
  <h3 id="tip-tip-viewing-figures"><i class="fa fa-lightbulb-o" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Viewing figures</h3>
  <ul>
    <li>Some of the figures are screenshots and it may be difficult to make out details</li>
    <li>Right-click on the image and choose ‘Open image in new tab’ to view</li>
    <li>Zoom in and out as needed to see the content</li>
  </ul>
</blockquote>

<figure id="figure-2"><img src="/training-material/topics/computational-chemistry/images/charmmgui.png" alt="CHARMM-GUI interface" /><figcaption><span class="figcaption-prefix">Figure 2:</span> The CHARMM-GUI interface</figcaption></figure>

<p>Go to the correct section depending on which MD engine you will be using.</p>

<h2 id="charmm">CHARMM</h2>

<h3 id="upload-the-pdb-to-charmm-gui">Upload the PDB to CHARMM-GUI</h3>
<p><a href="http://www.charmm-gui.org/?doc=input/pdbreader">Navigate to CHARMM-GUI</a> and use the Input Generator, specifically the PDB Reader tool and upload the Cellulase PDB file. Press ‘Next Step: Select Model/Chain’ in the bottom right corner.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-upload-the-pdb-to-charmm-gui"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Upload the PDB to CHARMM-GUI</h3>

  <ol>
    <li>Retrieve the modelled PDB structure from <a href="https://doi.org/10.5281/zenodo.2600690">Zenodo</a>.</li>
    <li>Upload the PDB and choose CHARMM format.</li>
  </ol>
  <figure id="figure-3"><img src="/training-material/topics/computational-chemistry/images/charmmgui-reader.png" alt="Snapshot of CHARMM-GUI PDB reader section" /><figcaption><span class="figcaption-prefix">Figure 3:</span> The CHARMM-GUI PDB Reader tool</figcaption></figure>
</blockquote>

<h3 id="select-both-protein-and-ligand-models">Select both protein and ligand models</h3>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-generate-pdb-file"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Generate PDB file</h3>
  <p>Two model chains are presented for selection: the protein (PROA) and the hetero residue, which is the ligand or glycan in this case (HETA). Select both, and press ‘Next Step: Generate PDB’ in the bottom right corner.</p>
  <figure id="figure-4"><img src="/training-material/topics/computational-chemistry/images/charmmgui-modelchain.png" alt="Snapshot of CHARMM-GUI model section" /><figcaption><span class="figcaption-prefix">Figure 4:</span> Select both ligand and protein models in CHARMM-GUI</figcaption></figure>
</blockquote>

<h3 id="manipulate-the-system">Manipulate the system</h3>
<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-make-necessary-modifications"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Make necessary modifications</h3>
  <p>Rename the hetero chain to BGLC and add ten disulfide bonds to the protein, as shown in the figure. Then press ‘Next Step: Manipulate PDB’ in the bottom right corner.</p>
  <figure id="figure-5"><img src="/training-material/topics/computational-chemistry/images/charmmgui-manipulate.png" alt="Snapshot of CHARMM-GUI renaming section" /><figcaption><span class="figcaption-prefix">Figure 5:</span> Rename the chains in CHARMM-GUI</figcaption></figure>
</blockquote>

<h3 id="download-the-output">Download the output</h3>
<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-download-charmm-output"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Download CHARMM output</h3>
  <p>The output is a .tgz file (a tarball or zipped tarball). Inside the archive you will see all inputs and outputs from CHARMM-GUI.</p>
  <figure id="figure-6"><img src="/training-material/topics/computational-chemistry/images/charmmgui-charmmoutput.png" alt="Snapshot of CHARMM-GUI CHARMM output section" /><figcaption><span class="figcaption-prefix">Figure 6:</span> CHARMM output from CHARMM-GUI</figcaption></figure>
</blockquote>

<blockquote class="tip">
  <h3 id="tip-what-is-a-tgz-file"><i class="fa fa-lightbulb-o" aria-hidden="true"></i><span class="visually-hidden">tip</span> What is a .tgz file?</h3>

  <p>This is a compressed file which contains all the output files created by the CHARMM-GUI. To access them, the .tgz file needs to be decompressed. There should be a tool available on your operating system for this. If you prefer to use the command line, tar will work fine on Linux or Mac <code class="highlighter-rouge">tar -zxvf example.tgz</code>. On Windows use <a href="https://www.7-zip.org/download.html">7zip</a>, or download Git for windows and use Git Bash.</p>
</blockquote>

<h3 id="upload-to-galaxy">Upload to Galaxy</h3>
<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-upload-files-to-galaxy"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Upload files to Galaxy</h3>
  <p>Upload the step1_pdbreader.psf and step1_pdbreader.crd files to your BRIDGE instance and run the system setup tool.</p>
</blockquote>

<h2 id="namd">NAMD</h2>

<h3 id="upload-the-pdb-to-charmm-gui-1">Upload the PDB to CHARMM-GUI</h3>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-upload-the-pdb-to-charmm-gui-1"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Upload the PDB to CHARMM-GUI</h3>
  <p>Retrieve the modelled PDB structure from <a href="https://doi.org/10.5281/zenodo.2600690">Zenodo</a>.
<a href="http://www.charmm-gui.org/?doc=input/mdsetup">Navigate to CHARMM-GUI</a> and use the Input Generator, specifically the Quick MD Simulator tool. Upload the PDB file, selecting ‘CHARMM’ as the file format. Press ‘Next Step: Select Model/Chain’ in the bottom right corner.</p>
  <figure id="figure-7"><img src="/training-material/topics/computational-chemistry/images/charmmgui-mdsimulator.png" alt="Snapshot of CHARMM-GUI Quick MD Simulator tool " /><figcaption><span class="figcaption-prefix">Figure 7:</span> The CHARMM-GUI Quick MD Simulator tool</figcaption></figure>
</blockquote>

<h3 id="select-both-protein-and-ligand-models-1">Select both protein and ligand models</h3>
<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-generate-pdb-file-1"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Generate PDB file</h3>
  <p>Two model chains are presented for selection: the protein (PROA) and the hetero residue, which is the ligand or glycan in this case (HETA). Select both, and press ‘Next Step: Generate PDB’ in the bottom right corner.</p>
  <figure id="figure-8"><img src="/training-material/topics/computational-chemistry/images/charmmgui-modelchain.png" alt="Snapshot of CHARMM-GUI model section" /><figcaption><span class="figcaption-prefix">Figure 8:</span> Select both ligand and protein models in CHARMM-GUI</figcaption></figure>
</blockquote>

<h3 id="manipulate-the-system-1">Manipulate the system</h3>
<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-make-necessary-modifications-1"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Make necessary modifications</h3>
  <p>Rename the hetero chain to BGLC and add disulfide bonds.</p>
  <figure id="figure-9"><img src="/training-material/topics/computational-chemistry/images/charmmgui-manipulate.png" alt="Snapshot of CHARMM-GUI renaming section" /><figcaption><span class="figcaption-prefix">Figure 9:</span> Rename the chains in CHARMM-GUI</figcaption></figure>
</blockquote>

<h3 id="set-up-the-waterbox-and-add-ions">Set up the waterbox and add ions</h3>
<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-solvate-the-protein"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Solvate the protein</h3>
  <p>Set up a waterbox. Use a size of 10 angstroms and choose a cubic box (‘rectangular’ option).</p>
  <figure id="figure-10"><img src="/training-material/topics/computational-chemistry/images/charmmgui-waterbox.png" alt="Snapshot of CHARMM-GUI waterbox section" /><figcaption><span class="figcaption-prefix">Figure 10:</span> Setting up a waterbox in CHARMM-GUI</figcaption></figure>
</blockquote>

<blockquote>
  <blockquote class="question">
    <h3 id="question-question"><i class="fa fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Question</h3>

    <p>Why is 10 angstrom a fair choice for the buffer?  Why choose 0.15M NaCl?</p>

    <blockquote class="solution">
      <h3 id="solution-solution"><i class="fa fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Solution</h3>
      <p>Under periodic boundary conditions, we need to ensure the protein can never interact with its periodic image, otherwise artefacts are introduced. Allowing 10 angstroms between the protein and the box edge ensures the two images will always be at minimum 20 angstroms apart, which is sufficient.</p>

      <p>Some of the residues on the protein surface are charged and counter-ions need to be present nearby to neutralise them. Failure to explicitly model salt ions may destabilise the protein.</p>
    </blockquote>
  </blockquote>
</blockquote>

<h3 class="details" id="generate-the-fft-automatically">Generate the FFT automatically</h3>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-generate-the-fft"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Generate the FFT</h3>
  <p>Particle Mesh Ewald (PME) summation is the method being used to calculate long-range interactions in this system. To improve the computational time a Fast Fourier Transform (FFT) is used. A detailed discussion of FFT will not be presented here; there are many articles on the subject. Try <a href="https://en.wikipedia.org/wiki/Ewald_summation">Wikipedia</a> and <a href="https://doi.org/10.1016/0010-4655(96)00016-1">Ewald summation techniques in perspective: a survey</a>.</p>
  <figure id="figure-11"><img src="/training-material/topics/computational-chemistry/images/charmmgui-fft.png" alt="Snapshot of CHARMM-GUI FFT section" /><figcaption><span class="figcaption-prefix">Figure 11:</span> Setting up a FFT in CHARMM-GUI</figcaption></figure>
</blockquote>

<h3 id="download-the-output-1">Download the output</h3>
<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-solvate-the-protein-1"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Solvate the protein</h3>
  <p>The output is a .tgz file (a tarball or zipped tarball). Inside the archive you will see all inputs and outputs from CHARMM-GUI.</p>
  <figure id="figure-12"><img src="/training-material/topics/computational-chemistry/images/charmmgui-namdoutput.png" alt="Snapshot of CHARMM-GUI NAMD output section" /><figcaption><span class="figcaption-prefix">Figure 12:</span> NAMD output from CHARMM-GUI</figcaption></figure>
</blockquote>

<blockquote class="tip">
  <h3 id="tip-what-is-a-tgz-file-1"><i class="fa fa-lightbulb-o" aria-hidden="true"></i><span class="visually-hidden">tip</span> What is a .tgz file?</h3>

  <p>This is a compressed file and needs to be uncompressed using the correct tool.
On Linux or Mac: tar will work fine <code class="highlighter-rouge">tar -zxvf example.tgz</code>.
On Windows use <a href="https://www.7-zip.org/download.html">7zip</a> or download Git for windows and use Git Bash.</p>
</blockquote>

<h3 id="upload-to-galaxy-1">Upload to Galaxy</h3>
<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-upload-files-to-galaxy-1"><i class="fa fa-pencil" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Upload files to Galaxy</h3>
  <p>Upload the following files to your BRIDGE instance and ensure the correct datatype is selected:</p>
  <ul>
    <li>step3_pbcsetup.xplor.ext.psf -&gt; xplor psf input (psf format)</li>
    <li>step3_pbcsetup.pdb -&gt; pdb input (pdb format)</li>
    <li>Checkfft.str -&gt; PME grid specs (txt format)</li>
    <li>step2.1_waterbox.prm -&gt; waterbox prm input (txt format)</li>
  </ul>
</blockquote>

<p>You are now ready to run the NAMD workflow, which is discussed in another <a href="/training-material/topics/computational-chemistry/tutorials/md-simulation-namd/tutorial.html">tutorial</a>.</p>

<h1 class="no_toc" id="conclusion">Conclusion</h1>

<p><i class="fa fa-trophy" aria-hidden="true"></i><span class="visually-hidden">trophy</span> Well done! You have started modelling a cellulase protein and uploaded it into Galaxy. The next step is running molecular dynamics simulations (<a href="/training-material/topics/computational-chemistry/tutorials/md-simulation-namd/tutorial.html">tutorial</a>)</p>



                    
                    <blockquote class="key_points">
                        <h3><i class="fa fa-key" aria-hidden="true"></i><span class="visually-hidden">keypoints</span> Key points</h3>

                        <ul>
                            
                            <li>The PDB is a key resource for finding protein structures.</li>
                            
                            <li>Using CHARMM-GUI is one way to prepare a protein and ligand system.</li>
                            
                            <li>To get data into Galaxy you can upload a file from your computer or paste in a web address.</li>
                            
                        </ul>
                    </blockquote>
                    

                    
                    <h1 data-toc-skip>Useful literature</h1>
                    <p>Further information, including links to documentation and original publications, regarding the tools, analysis techniques and the interpretation of results described in this tutorial can be found <a href="/training-material/topics/computational-chemistry#references">here</a>.</p>
                    

                    
                    <h1 id="bibliography">References</h1>
                    <ol class="bibliography"><li><span id="barnett11">Barnett, C. B., K. A. Wilkinson, and K. J. Naidoo, 2011 <b>Molecular Details from Computational Reaction Dynamics for the Cellobiohydrolase I Glycosylation Reaction</b>. Journal of the American Chemical Society 133: 19474–19482.</span>
    
    
    <a href="https://doi.org/10.1021/ja206842j">10.1021/ja206842j</a>
    
    
      <!-- prevent duplicate doi links -->
      
    

</li>
<li><span id="jo17">Jo, S., X. Cheng, J. Lee, S. Kim, S.-J. Park <i>et al.</i>, 2016 <b>CHARMM-GUI 10 years for biomolecular modeling and simulation</b>. Journal of Computational Chemistry 38: 1114–1124.</span>
    
    
    <a href="https://doi.org/10.1002/jcc.24660">10.1002/jcc.24660</a>
    
    
      <!-- prevent duplicate doi links -->
      
    

</li></ol>
                    

                </div>
            </div>
        </div>

        <h3><i class="fa fa-thumbs-up" aria-hidden="true"></i><span class="visually-hidden">congratulations</span> Congratulations on successfully completing this tutorial!</h3>

        

        
        <blockquote class="agenda follow-up">
            <strong class="follow-up"><i class="fa fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Do you want to extend your knowledge? Follow one of our recommended follow-up trainings:</strong>
            <ul>
                
    <li>
    
        
        
        <a href="/training-material/topics/computational-chemistry">Computational chemistry</a>
        
            <ul>
                
                    
                        
                    
                        
                    
                        
                            
                            <li> Running molecular dynamics simulations using NAMD:
                            
                            
                                
                                     <a href="/training-material/topics/computational-chemistry/tutorials/md-simulation-namd/tutorial.html"><i class="fa fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on</a>
                                
                            
                            </li>
                        
                    
                        
                    
                
            </ul>
        
    
    </li>

            </ul>
        </blockquote>
        

        <hr>
        <br>

        <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=Setting up molecular systems (Computational chemistry)">Loading...
        </iframe>

        <blockquote class="feedback">
            <h3><i class="fa fa-comments-o" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Give us even more feedback on this content!</h3>
            <p>To give us more detailed feedback about these materials, please take a moment to fill in the extended <a href="https://docs.google.com/forms/d/e/1FAIpQLSc_GLZRpxZGAL9tN6DA1bE6WkNhmQdXT7B16TpOb-X4YwKUsQ/viewform?entry.1548889262=Setting up molecular systems (Computational chemistry)">Feedback Form</a>.</p>
        </blockquote>
    </section>
</div>


<footer>
    <div class="container">
        <p>
            This material is the result of a collaborative work. Thanks to the
            <a href="https://wiki.galaxyproject.org/Teach/GTN">Galaxy Training Network</a>
            and all the <a href="/training-material/hall-of-fame">contributors</a> (Chris Barnett, Simon Bray)!
        </p>
        <p>
            Found a typo? Something is wrong in this tutorial? Edit it on
            <a href="https://github.com/galaxyproject/training-material/tree/master/topics/computational-chemistry/tutorials/setting-up-molecular-systems/tutorial.md">GitHub</a>.
        </p>
    </div>
</footer>

    </body>
    <script type="text/javascript" src="/training-material/assets/js/jquery.slim.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/popper.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap.min.js?v=3"></script>
    <script type="text/javascript" src="/training-material/assets/js/details-element-polyfill.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap-toc.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/main.js"></script>

    <script type="text/javascript" src="/training-material/assets/js/clipboard.min.js"></script>
    <script type="text/javascript">
    var snippets=document.querySelectorAll('div.highlight');
    [].forEach.call(snippets,function(snippet){
        snippet.firstChild.insertAdjacentHTML('beforebegin','<button class="btn btn-light" data-clipboard-snippet><i class="fa fa-copy"></i>&nbsp;Copy</button>');
    });

    var clipboardSnippets=new ClipboardJS('[data-clipboard-snippet]',{
        target:function(trigger){return trigger.nextElementSibling;
    }});
    </script>
</html>
